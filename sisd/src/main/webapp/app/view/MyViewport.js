/*
 * File: app/view/MyViewport.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.view.MyViewport', {
    extend: 'Ext.container.Viewport',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'container',
                    layout: {
                        align: 'stretch',
                        type: 'vbox'
                    },
                    items: [
                        {
                            xtype: 'form',
                            itemId: 'eventForm',
                            maxWidth: 802,
                            width: 700,
                            bodyPadding: 10,
                            bodyStyle: 'background-color:#D8E5F3;',
                            title: 'Event Form',
                            items: [
                                {
                                    xtype: 'textfield',
                                    anchor: '100%',
                                    fieldLabel: 'Event Name',
                                    labelAlign: 'right',
                                    name: 'name',
                                    fieldStyle: ''
                                },
                                {
                                    xtype: 'textfield',
                                    anchor: '100%',
                                    fieldLabel: 'Location',
                                    labelAlign: 'right',
                                    submitValue: false
                                },
                                {
                                    xtype: 'datefield',
                                    anchor: '100%',
                                    fieldLabel: 'Start Date',
                                    labelAlign: 'right',
                                    name: 'startTime'
                                },
                                {
                                    xtype: 'datefield',
                                    anchor: '100%',
                                    fieldLabel: 'End Date',
                                    labelAlign: 'right',
                                    name: 'endTime'
                                },
                                {
                                    xtype: 'textfield',
                                    anchor: '100%',
                                    fieldLabel: 'Organizer',
                                    labelAlign: 'right',
                                    submitValue: false
                                }
                            ],
                            dockedItems: [
                                {
                                    xtype: 'toolbar',
                                    dock: 'top',
                                    items: [
                                        {
                                            xtype: 'button',
                                            icon: 'img/tick.png',
                                            text: 'Submit',
                                            listeners: {
                                                click: {
                                                    fn: me.onButtonClick,
                                                    scope: me
                                                }
                                            }
                                        },
                                        {
                                            xtype: 'button',
                                            icon: 'img/icon_clear.png',
                                            text: 'Clear',
                                            listeners: {
                                                click: {
                                                    fn: me.onButtonClick1,
                                                    scope: me
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            xtype: 'gridpanel',
                            height: 300,
                            maxWidth: 802,
                            width: 760,
                            title: 'Event Details',
                            emptyText: '<center><br><i><span style="font-size:12px;color:black;">No Event Details</span></i></center>',
                            store: 'Events',
                            columns: [
                                {
                                    xtype: 'gridcolumn',
                                    width: 160,
                                    dataIndex: 'name',
                                    text: 'Event Name'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    width: 160,
                                    dataIndex: 'address',
                                    text: 'Location'
                                },
                                {
                                    xtype: 'datecolumn',
                                    width: 160,
                                    dataIndex: 'startTime',
                                    text: 'Start Date'
                                },
                                {
                                    xtype: 'datecolumn',
                                    width: 160,
                                    dataIndex: 'endTime',
                                    text: 'End Date'
                                },
                                {
                                    xtype: 'gridcolumn',
                                    width: 160,
                                    dataIndex: 'organizer',
                                    text: 'Organizer'
                                }
                            ],
                            viewConfig: {
                                emptyText: '<center><br><i><span style="font-size:12px;color:black;">No Event Details</span></i></center>'
                            }
                        }
                    ]
                }
            ]
        });

        me.callParent(arguments);
    },

    onButtonClick: function(button, e, eOpts) {
        var eventModel = Ext.create('MyApp.model.Event');
        //this.getNotePopup().setLoading({msg: 'Saving Note...'});
        var eventsStore = Ext.data.StoreManager.lookup('Events');


        button.up('#eventForm').updateRecord(eventModel);
        eventModel.set('address', {street1: 'test', street2: 'street2', city: 'city', state: 'state', zip: 'zip', country: 'country'});
        eventModel.set('organizer', {email: 'email', firstName: 'firstName', lastName: 'lastName'});
        eventsStore.insert(0, eventModel);
        eventsStore.sync({
            success: function(record, operation) {
                button.up('#eventForm').getForm().reset();
            },
            failure: function(record, operation) {
                alert('failure');
            }
        });

    },

    onButtonClick1: function(button, e, eOpts) {
        button.up('#eventForm').getForm().reset();

    }

});